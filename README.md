# politalk_extractor
정치인 발언발췌 프로젝트

정치인 발언 데이터 자동 추출 및 가공 도구

## 개요
정치인 발언 데이터에서 발언자, 목적, 주제, 요약 등 다양한 정보를 자동으로 추출하여 CSV → Excel로 변환하는 Python 기반 도구입니다.  
GUI를 통해 손쉽게 파일을 선택하고, AI/NLP 기반으로 데이터를 정제·가공할 수 있습니다.

---

## 입력 데이터 형식 (CSV)

| 이름 | URL | 신문사 | 제목 | 발췌문단 | 발췌문장 | 일자 |
|------|-----|--------|------|----------|----------|------|
| 고민정 | http://www.segye.com/... | 세계일보 | '이재명 9월 영장설'에 민주당 계파 갈등? | 고민정 최고위원도 전날 CBS 라디오에... | "김은경 혁신위원회에서 제안했던..." | 20230824 |
| 고민정 | http://www.segye.com/... | 세계일보 | '이재명 9월 영장설'에 민주당 계파 갈등? | 그러면서 "일단 한 번 내뱉은 말에... | "일단 한 번 내뱉은 말에 대해서는..." | 20230824 |

- **필수 컬럼:** 이름, URL, 신문사, 제목, 발췌문단, 발췌문장, 일자
- **실제 입력 파일:** `업로드용파일_20250114_145746_고민정.csv`

---

## 출력 데이터 형식 (Excel)

프로그램 실행 후 생성되는 Excel 파일에는 다음과 같은 컬럼들이 포함됩니다:
- **날짜**: 발언 일자
- **발언자 성명 및 직책**: 발언자 정보
- **신문사**: 기사 출처 신문사
- **기사 제목**: 원본 기사 제목
- **발언의 배경**: AI가 추출한 발언의 배경
- **문단**: 발췌문단 번호
- **발언의 목적 취지**: AI가 분석한 발언의 목적과 취지
- **발언**: 실제 발언 내용

- **실제 출력 파일:** `업로드용파일_20250114_145746_고민정_AI변환_250901.xlsx`

---

## 입출력 파일 예시

### 입력 CSV 예시 (실제 데이터)
```csv
이름,URL,신문사,제목,발췌문단,발췌문장,일자
고민정,http://www.segye.com/content/html/2023/08/23/20230823511910.html,세계일보,'이재명 9월 영장설'에 민주당 계파 갈등?,"고민정 최고위원도 전날 CBS 라디오에 나와...","김은경 혁신위원회에서 제안했던, 체포동의안에 대한 민주당 스탠스...",20230824
```

### 출력 Excel 파일
- 파일명: `업로드용파일_20250114_145746_고민정_AI변환_250901.xlsx`
- AI가 자동으로 주제와 발언 목적을 분석하여 추가된 컬럼들이 포함된 Excel 파일

---

## 주요 기능 및 처리 방식

### 1. CSV 데이터 추출 및 전처리
- 입력 CSV 파일에서 각 행을 읽어 발언자, 기사 제목, 발췌문장 등 주요 정보를 추출합니다.
- `file_manager.py`의 `extract_text_from_csv()` 함수가 담당합니다.
- 쉼표 등으로 분리된 복수 문장도 개별적으로 처리합니다.
- 인코딩 자동 감지(`chardet`)를 통해 다양한 CSV 파일 형식을 지원합니다.

### 2. 텍스트 정제 및 발언자 추출
- `text_manager.py`의 다양한 함수들이 텍스트를 정제합니다.
- 발언문에서 큰따옴표 내용을 추출하고 정제합니다.
- 발언자 정보를 자동으로 추출하고 정규화합니다.

### 3. 발언 목적/배경/취지 추출
- `extract_purpose.py`에서 기사 제목, 발언문, 문단 등 맥락을 바탕으로 발언의 목적을 분석합니다.
- Transformers 라이브러리의 파이프라인을 활용한 NLP 기반 분석을 수행합니다.
- 불필요한 접속사나 문구를 제거하고 핵심 내용을 추출합니다.

### 4. 주제 및 요약 추출
- `extract_topic_summary.py`의 `TopicExtractor` 클래스가 담당합니다.
- T5 기반 한국어 텍스트 요약 모델(`lcw99/t5-base-korean-text-summary`)을 사용합니다.
- 기사 제목, 발언문, 목적/배경/취지 등을 종합하여 주제를 자동 추출합니다.

### 5. GUI 및 파일 관리
- `gui_manager.py`에서 Tkinter 기반 GUI를 제공합니다.
- 파일 선택, 변환 실행, 진행상황 표시 기능을 포함합니다.
- `main.py`에서 로그인 후 GUI를 실행합니다.
- 결과는 Excel(.xlsx) 형식으로 저장되며, 파일명에 날짜가 자동으로 포함됩니다.

### 6. 로그인 시스템
- `login.py`에서 간단한 로그인 창을 제공합니다.
- 프로그램 실행 전 인증 과정을 거칩니다.

---

## 실행 방법

1. **Python 3.x 환경 준비**
   - Python 3.7 이상 권장
   - CUDA 지원 GPU가 있으면 더 빠른 처리 가능

2. **필수 패키지 설치**
   ```bash
   pip install -r requirements.txt
   ```
   
3. **프로그램 실행**
   ```bash
   python main.py
   ```

4. **사용 방법**
   - 로그인 창에서 인증
   - GUI에서 CSV 파일 선택
   - Excel 저장 경로 설정 (자동으로 제안됨)
   - 변환 실행 버튼 클릭
   - 진행상황을 실시간으로 확인

---

## 주요 파일 설명

### 핵심 실행 파일
- **`main.py`**: 프로그램 진입점, JAVA_HOME 설정, 로그인 후 GUI 실행
- **`gui_manager.py`**: Tkinter 기반 메인 GUI 인터페이스
- **`login.py`**: 로그인 창 및 인증 처리

### 데이터 처리 파일
- **`file_manager.py`**: CSV 파일 읽기, Excel 파일 저장, 데이터 전처리
- **`text_manager.py`**: 텍스트 정제, 발언자 추출, 문장 분리 등 텍스트 처리
- **`extract_purpose.py`**: 발언의 목적/배경/취지 추출 (Transformers 기반)
- **`extract_topic_summary.py`**: 주제 및 요약 추출 (T5 모델 기반)

### 테스트 파일
- **`test_all_files.py`**: 전체 기능 테스트

---

## 시스템 요구사항

### 필수 요구사항
- Python 3.7+
- Java JDK (자동 감지 및 설정)
- 최소 4GB RAM (AI 모델 로딩용)

### 권장 사양
- CUDA 지원 GPU (NVIDIA)
- 8GB+ RAM
- SSD 저장공간

### 설치되는 주요 패키지
- `pandas`: 데이터 처리
- `openpyxl`: Excel 파일 처리
- `transformers`: AI 모델 (T5, BERT 등)
- `torch`: 딥러닝 프레임워크
- `stanza`: 한국어 NLP 처리
- `nltk`: 자연어 처리
- `chardet`: 인코딩 자동 감지

---

## 사용 예시

1. **입력**: `업로드용파일_20250114_145746_고민정.csv`
2. **처리**: AI가 자동으로 주제와 발언 목적 분석
3. **출력**: `업로드용파일_20250114_145746_고민정_AI변환_250901.xlsx`

---

## 라이선스
이 프로젝트는 연구 및 교육 목적으로 개발되었습니다.
